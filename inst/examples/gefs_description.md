
# Snapshots of Global Ensemble Forecast System (GEFS) at NEON sites

The [Ecological Forecasting Initiative](https://ecoforecast.org) extracts
and distributes the forecasts produced by NOAA's 35-day, 31-ensemble
member forecast system for [25 variables]() 
at surface-height for [81 NEON sites]().

## Stage-1

### Quick access

Use `arrow` for quick remote access to the database:

```{r}
library(arrow)
library(glue)
date <- "2020-09-24"
s3 <- s3_bucket(glue("bio230014-bucket01/neon4cast-drivers/noaa",
                       "/gefs-v12/stage1/reference_datetime={date}"),
                endpoint_override = "https://sdsc.osn.xsede.org", 
                anonymous = TRUE)
stage1 <- open_dataset(s3)
```

Use `dplyr` commands to subset the desired data

```{r}
library(dplyr)
stage1 |> 
  filter(variable == "TMP",
         site_id == "BART") |>
  group_by(datetime) |>
  summarise(temp = mean(prediction)) |>
  collect() |> arrange(datetime)
```


### Summary

Forecasts are provided each day at midnight UTC.
Forecasts extend for a 35 day horizon.
Forecasts of the first 10 days (240 hours) use a 3 hr interval,
while forecasts of the following 25 days use a 6 hr interval. 

Please note that certain flux data, such as accumulated precipitation, are given for the 6-hr period prior to the `datetime` for horizons divisible by 6, and for a 3-hr period for others.

Stage-1 product comprises data produced under GEFS v11 and v12 models. 
Forecasts issued prior to 2020-09-27 are generated by the GEFS v11 model, and include only day horizon and only 21 ensemble members.
v11 data are provided in a separate endpoint to reduce potential data artefacts.

All data are provided as-is without guarantee of accuracy. Please
consult original data products and generation scripts for details.

# Psuedo-measurement

```r
library(arrow); library(dplyr)
s3 <- s3_bucket(paste0("bio230014-bucket01/neon4cast-drivers/noaa",
                       "/gefs-v12/pseudo"),
                endpoint_override = "https://sdsc.osn.xsede.org", 
                anonymous = TRUE)
pseudo <- open_dataset(s3)

```
